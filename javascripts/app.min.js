"use strict";var timeLineOnStart=function e(){console.log("timeLineOnStart"),startBtn.disabled=!0,pauseBtn.disabled=!1,resetBtn.disabled=!1},timeLineOnComplete=function e(){console.log("timeLineOnComplete"),startBtn.disabled=!1,pauseBtn.disabled=!0,resetBtn.disabled=!0},onComplete=function e(t){console.log("onComplete"),console.log(t)},checkHit=function e(t){Draggable.hitTest(catcher,t)&&TweenMax.to(t,.5,{backgroundColor:"green"})},gameBox=document.querySelector("#gameBox"),orientation=document.querySelector("#orientation"),gift=document.querySelector(".elements .gift"),catcher=document.querySelector("#gameBox .catcher"),startBtn=document.querySelector("#startBtn"),pauseBtn=document.querySelector("#pauseBtn"),resetBtn=document.querySelector("#resetBtn"),MaxPoint=2e4,pointBillList=[1e3,800,600,400,200],pointList=[],moveWidth=40,gameTime=60,gameStatus="stop",timeLine=new TimelineMax({delay:.5,onStart:timeLineOnStart,onComplete:timeLineOnComplete}),addGift=function e(t){var n=gift.cloneNode();n.dataset.point=t,gameBox.append(n);var o=gameBox.offsetWidth-moveWidth,i=random(moveWidth,o),a=gameBox.offsetHeight+moveWidth,r=random(2,4),s=random(0,gameTime-5);return console.log({x:i,y:0}),timeLine.fromTo(n,r,{x:i,y:0},{y:"+="+o,ease:Power0.easeNone,onComplete:function e(){n.remove()},onUpdate:function e(){checkHit(n)}},s),n},pointListGenerator=function e(t,n){var o=[],i=0;do{i=t[randomRound(0,t.length-1)]||0,i>t[0]&&(t.shift(),console.log("shift: "+t)),i<=n&&(n-=i,o.push(i))}while(n>0);return o},onChangeOrientation=function e(t){var n=t.alpha,o=t.beta,i=t.gamma,a={alpha:Math.round(n),beta:Math.round(o),gamma:Math.round(i)};orientation.innerHTML=JSON.stringify(a),console.log(a)},move=function e(){window.DeviceOrientationEvent?(console.log("in move"),orientation.innerHTML="in Move",window.addEventListener("deviceorientation",onChangeOrientation,!1)):(console.log("not support orientation"),orientation.innerHTML="not support orientation")},start=function e(){timeLine.clear(),pointList=shuffle(pointListGenerator(pointBillList,MaxPoint)),pointList.forEach(function(e,t){addGift(e)}),timeLine.play(0)},cleanItems=function e(t){gameBox.querySelectorAll(".gift").forEach(function(e,t){gameBox.removeChild(e)}),"function"==typeof t&&t()},keyDownEvent=function e(t){t.keyCode&&39===t.which&&TweenMax.to(catcher,.2,{x:"+="+gameBox.offsetWidth/30}),t.keyCode&&37===t.which&&TweenMax.to(catcher,.2,{x:"-="+gameBox.offsetWidth/30}),console.log(t)},addkeyDownEvent=function e(){console.log("addkeyDownEvent"),document.addEventListener("keydown",keyDownEvent)},removekeyDownEvent=function e(){console.log(e),document.removeEventListener("keydown",keyDownEvent)},randomRound=function e(t,n){return Math.round(Math.random()*(n-t)+t)},random=function e(t,n){return Math.random()*(n-t)+t},shuffle=function e(t){for(var n=t.length-1;n>0;n--){var o=Math.floor(Math.random()*(n+1)),i=[t[o],t[n]];t[n]=i[0],t[o]=i[1]}return t},reducer=function e(t,n){return t+n},startEvent=function e(){timeLine._time>=timeLine.endTime()||0===timeLine._time?(console.log("click to start"),cleanItems(start)):timeLine.play(),startBtn.disabled=!0,pauseBtn.disabled=!1,resetBtn.disabled=!1,addkeyDownEvent()},pauseEvent=function e(){timeLine.paused(!0),startBtn.disabled=!1,pauseBtn.disabled=!0,removekeyDownEvent()},resetEvent=function e(){console.log("click to reset"),cleanItems(start),startBtn.disabled=!0,pauseBtn.disabled=!1,removekeyDownEvent(),addkeyDownEvent()};startBtn.addEventListener("click",startEvent),startBtn.addEventListener("touchend",startEvent),pauseBtn.addEventListener("click",pauseEvent),pauseBtn.addEventListener("touchend",pauseEvent),resetBtn.addEventListener("click",resetEvent),resetBtn.addEventListener("touchend",resetEvent),startBtn.disabled=!1,move(),TweenMax.set(catcher,{x:gameBox.offsetWidth/2-catcher.offsetWidth/2,y:gameBox.offsetHeight-catcher.offsetHeight-200});